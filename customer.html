<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buyer Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #F5F5F5; padding: 20px; color:#3E2723; }
        .card { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }
        .btn { background: #4E342E; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="card">
        <h2>My Profile</h2>
        <input id="c-name" placeholder="Name">
        <input id="c-phone" placeholder="Phone">
        <button class="btn" onclick="save()">Save</button>
    </div>
    <div class="card">
        <h3><i class="fa-solid fa-store"></i> <a href="index.html">Go to Marketplace</a></h3>
    </div>
    <script>
        const firebaseConfig = { apiKey: "AIzaSyCbqz4vsik5tiuAUvIL_-FiquhrZcXX0N0", authDomain: "furnicohub.firebaseapp.com", projectId: "furnicohub", storageBucket: "furnicohub.firebasestorage.app", messagingSenderId: "395576125006", appId: "1:395576125006:web:a848f68053c69409ddc51f" };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        auth.onAuthStateChanged(u => {
            if(!u) auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
            else {
                db.collection('users').doc(u.uid).get().then(doc => {
                    if(doc.exists) {
                        document.getElementById('c-name').value = doc.data().name || '';
                        document.getElementById('c-phone').value = doc.data().phone || '';
                    }
                });
            }
        });

        function save() {
            db.collection('users').doc(auth.currentUser.uid).set({
                name: document.getElementById('c-name').value,
                phone: document.getElementById('c-phone').value,
                role: 'customer'
            }, {merge:true}).then(() => alert("Saved!"));
        }
    </script>
</body>
</html>
